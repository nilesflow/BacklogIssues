# BacklogIssues

本ソースは`Google App Script`の ライブラリとして存在している。  
対応するスプレッドシートから本ライブラリの`main.gs`の各関数をコールしている。  

## スプレッドシートの使い方
- 下記のスプレッドシートをコピー  
https://docs.google.com/spreadsheets/d/1qa8MxYjjgXQ-aV1UEHGKFI77a6rF581RlBSknV7xFQ4/edit#gid=1194134501

- 「config」シートに`backlog`の host, APIキー を入力  
※APIキーは、`backlog`の「個人設定」「API」「新しいAPIキーを発行」から「登録」で作成

- 必要に応じて、「config」シートの各値を修正

- スプレッドシートの「Backlog」メニューが表示されるので、  
「Backlogから課題情報を読み込み」

## できること
### 取得情報
- 複数スペース情報
- 各スペースの全アクセス可能プロジェクト情報
- アーカイブ済みプロジェクト（選択可）
- 各プロジェクトの全課題
- 非完了タスクの表示期限をX日で指定
- 直近X日の完了タスクの表示
- 1課題につき最大X個のコメント表示

### 強調表示
- スペース／プロジェクト行の表示、及び非表示
- 直近X日の追加タスク行のフォント色強調表示
- 直近X日の変更タスクのフォント色強調表示
- X日以内の期限日のタスクの背景色強調表示
- 期限日超過タスクの背景色強調表示
- 完了タスクの背景色強調表示  
※いずれも、フォント／背景色を指定可能

### 表示
- スペース、プロジェクトへのリンク
- カテゴリー、マイルストーンへのリンク  
  ※スプレッドシートの仕様上、最初の一つへリンク
- コメントの最大表示文字数指定
- 表示項目の指定機能
- 課題のソート項目／順序の指定

### メニュー機能
- 複数回に分けての課題の分割取得  
  ※`Google App Script`の最大実行時間対策
- 表示内容（及び、読み込み状態）のクリア
- 行／列サイズのリセット
- 折り返し指定切り替えによる「状況」列の高さ調節機能

## アプリケーションの更新
スプレッドシートコピー後のバージョンアップの方法は、 

### スプレッドシートの更新
下記のファイルの更新は手動で変更する必要がある  
`trigger.gs`  
※実行コードはほぼ全てライブラリ側に実装しており、殆ど変更の内容に作成

### ライブラリの更新
上記以外のライブラリ側の更新は、ライブラリのバージョン指定で更新。

- スクリプトエディタを開く  
  スプレッドシートの「ツール」「スクリプトエディタ」

- ライブラリを開く  
  スクリプトエディタの「リソース」「ライブラリ」

- ライブラリを更新   
   「BacklogIssuesLibrary」の「バージョン」を変更

## ライセンス
[GPLv3](https://github.com/nilesflow/BacklogIssues/blob/master/LICENSE)
